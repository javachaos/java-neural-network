/*******************************************************************************
 * Copyright (c) 2013 Fred .
 * All rights reserved. This program and the accompanying
 * materials are made available under the terms of the GNU
 * Public License v3.0 which accompanies this distribution,
 * and is available at http://www.gnu.org/licenses/gpl.html
 *
 * Contributors:
 *      Fred  - initial API and implementation
 ******************************************************************************/
package com.github.javachaos.javaneuralnetwork.core;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

import java.util.Arrays;

/**
 * Main class.
 *
 * 
 *
 */
public final class Main {

    private static final Logger LOGGER = LogManager.getLogger(Main.class);
    /**
     * Unused ctor.
     */
    private Main() {
    }

    /**
     * Main method.
     * @param args
     *      command line args
     */
    public static void main(final String[] args) {

        int[] layerSizes = new int[] { 10, 5, 3, 5, 10 };
        TransferFunctions.TransferFunction[] tFuncs = new TransferFunctions.TransferFunction[] {
                TransferFunctions.TransferFunction.NONE,
                TransferFunctions.TransferFunction.RELU,
                TransferFunctions.TransferFunction.SIGMOID,
                TransferFunctions.TransferFunction.RELU,
                TransferFunctions.TransferFunction.SIGMOID};
        BackpropagationNetwork bpn = new BackpropagationNetwork(
                layerSizes, tFuncs);
        double[][] input = new double[][] {
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.6, 0.6, 0.8, 0.4, 0.2, 0.1, 0.3, 0.6},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.6, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.6, 0.1, 0.3, 0.8, 0.4, 0.6, 0.1, 0.3, 0.8},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
//1
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.6, 0.6, 0.8, 0.4, 0.2, 0.1, 0.3, 0.6},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.6, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.6, 0.1, 0.3, 0.8, 0.4, 0.6, 0.1, 0.3, 0.8},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
//2
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.6, 0.6, 0.8, 0.4, 0.2, 0.1, 0.3, 0.6},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.6, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.6, 0.1, 0.3, 0.8, 0.4, 0.6, 0.1, 0.3, 0.8},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
//3
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.6, 0.6, 0.8, 0.4, 0.2, 0.1, 0.3, 0.6},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.6, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.6, 0.1, 0.3, 0.8, 0.4, 0.6, 0.1, 0.3, 0.8},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
//4
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.6, 0.6, 0.8, 0.4, 0.2, 0.1, 0.3, 0.6},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.6, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.6, 0.1, 0.3, 0.8, 0.4, 0.6, 0.1, 0.3, 0.8},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
//5
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.6, 0.6, 0.8, 0.4, 0.2, 0.1, 0.3, 0.6},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.1, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8},
                { 0.6, 0.6, 0.2, 0.2, 0.3, 0.7, 0.4, 0.3, 0.65, 0.32},
                { 0.4, 0.6, 0.1, 0.3, 0.8, 0.4, 0.6, 0.1, 0.3, 0.8},
                { 0.4, 0.2, 0.1, 0.3, 0.8, 0.4, 0.2, 0.1, 0.3, 0.8}};
        double[][] desired = new double[][] {
                { 0.91, 0.86, 0.72, 0.62, 0.53, 0.41, 0.34, 0.23, 0.165, 0.532},
                { 0.34, 0.82, 0.71, 0.63, 0.58, 0.4, 0.32, 0.21, 0.13, 0.8},
                { 0.561, 0.86, 0.76, 0.62, 0.53, 0.41, 0.34, 0.3, 0.165, 0.532},
                { 0.94, 0.82, 0.71, 0.63, 0.58, 0.41, 0.32, 0.21, 0.13, 0.8},
                { 0.71, 0.806, 0.72, 0.62, 0.53, 0.41, 0.34, 0.23, 0.165, 0.332},
                { 0.81, 0.86, 0.72, 0.62, 0.5, 0.41, 0.34, 0.23, 0.165, 0.632},
                { 0.94, 0.82, 0.76, 0.63, 0.5, 0.4, 0.32, 0.21, 0.13, 0.8},
                { 0.74, 0.82, 0.71, 0.66, 0.58, 0.4, 0.32, 0.21, 0.13, 0.63},
                { 0.91, 0.86, 0.72, 0.62, 0.53, 0.1, 0.34, 0.23, 0.165, 0.3256},
                { 0.94, 0.82, 0.71, 0.63, 0.58, 0.1, 0.23, 0.1, 0.13, 0.82},
//1
                { 0.91, 0.86, 0.72, 0.62, 0.53, 0.41, 0.34, 0.23, 0.165, 0.532},
                { 0.34, 0.82, 0.71, 0.63, 0.58, 0.4, 0.32, 0.21, 0.13, 0.8},
                { 0.561, 0.86, 0.76, 0.62, 0.53, 0.41, 0.34, 0.3, 0.165, 0.532},
                { 0.94, 0.82, 0.71, 0.63, 0.58, 0.41, 0.32, 0.21, 0.13, 0.8},
                { 0.71, 0.806, 0.72, 0.62, 0.53, 0.41, 0.34, 0.23, 0.165, 0.332},
                { 0.81, 0.86, 0.72, 0.62, 0.5, 0.41, 0.34, 0.23, 0.165, 0.632},
                { 0.94, 0.82, 0.76, 0.63, 0.5, 0.4, 0.32, 0.21, 0.13, 0.8},
                { 0.74, 0.82, 0.71, 0.66, 0.58, 0.4, 0.32, 0.21, 0.13, 0.63},
                { 0.91, 0.86, 0.72, 0.62, 0.53, 0.1, 0.34, 0.23, 0.165, 0.3256},
                { 0.94, 0.82, 0.71, 0.63, 0.58, 0.1, 0.23, 0.1, 0.13, 0.82},
//2
                { 0.91, 0.86, 0.72, 0.62, 0.53, 0.41, 0.34, 0.23, 0.165, 0.532},
                { 0.34, 0.82, 0.71, 0.63, 0.58, 0.4, 0.32, 0.21, 0.13, 0.8},
                { 0.561, 0.86, 0.76, 0.62, 0.53, 0.41, 0.34, 0.3, 0.165, 0.532},
                { 0.94, 0.82, 0.71, 0.63, 0.58, 0.41, 0.32, 0.21, 0.13, 0.8},
                { 0.71, 0.806, 0.72, 0.62, 0.53, 0.41, 0.34, 0.23, 0.165, 0.332},
                { 0.81, 0.86, 0.72, 0.62, 0.5, 0.41, 0.34, 0.23, 0.165, 0.632},
                { 0.94, 0.82, 0.76, 0.63, 0.5, 0.4, 0.32, 0.21, 0.13, 0.8},
                { 0.74, 0.82, 0.71, 0.66, 0.58, 0.4, 0.32, 0.21, 0.13, 0.63},
                { 0.91, 0.86, 0.72, 0.62, 0.53, 0.1, 0.34, 0.23, 0.165, 0.3256},
                { 0.94, 0.82, 0.71, 0.63, 0.58, 0.1, 0.23, 0.1, 0.13, 0.82},
//3
                { 0.91, 0.86, 0.72, 0.62, 0.53, 0.41, 0.34, 0.23, 0.165, 0.532},
                { 0.34, 0.82, 0.71, 0.63, 0.58, 0.4, 0.32, 0.21, 0.13, 0.8},
                { 0.561, 0.86, 0.76, 0.62, 0.53, 0.41, 0.34, 0.3, 0.165, 0.532},
                { 0.94, 0.82, 0.71, 0.63, 0.58, 0.41, 0.32, 0.21, 0.13, 0.8},
                { 0.71, 0.806, 0.72, 0.62, 0.53, 0.41, 0.34, 0.23, 0.165, 0.332},
                { 0.81, 0.86, 0.72, 0.62, 0.5, 0.41, 0.34, 0.23, 0.165, 0.632},
                { 0.94, 0.82, 0.76, 0.63, 0.5, 0.4, 0.32, 0.21, 0.13, 0.8},
                { 0.74, 0.82, 0.71, 0.66, 0.58, 0.4, 0.32, 0.21, 0.13, 0.63},
                { 0.91, 0.86, 0.72, 0.62, 0.53, 0.1, 0.34, 0.23, 0.165, 0.3256},
                { 0.94, 0.82, 0.71, 0.63, 0.58, 0.1, 0.23, 0.1, 0.13, 0.82},
//4
                { 0.91, 0.86, 0.72, 0.62, 0.53, 0.41, 0.34, 0.23, 0.165, 0.532},
                { 0.34, 0.82, 0.71, 0.63, 0.58, 0.4, 0.32, 0.21, 0.13, 0.8},
                { 0.561, 0.86, 0.76, 0.62, 0.53, 0.41, 0.34, 0.3, 0.165, 0.532},
                { 0.94, 0.82, 0.71, 0.63, 0.58, 0.41, 0.32, 0.21, 0.13, 0.8},
                { 0.71, 0.806, 0.72, 0.62, 0.53, 0.41, 0.34, 0.23, 0.165, 0.332},
                { 0.81, 0.86, 0.72, 0.62, 0.5, 0.41, 0.34, 0.23, 0.165, 0.632},
                { 0.94, 0.82, 0.76, 0.63, 0.5, 0.4, 0.32, 0.21, 0.13, 0.8},
                { 0.74, 0.82, 0.71, 0.66, 0.58, 0.4, 0.32, 0.21, 0.13, 0.63},
                { 0.91, 0.86, 0.72, 0.62, 0.53, 0.1, 0.34, 0.23, 0.165, 0.3256},
                { 0.94, 0.82, 0.71, 0.63, 0.58, 0.1, 0.23, 0.1, 0.13, 0.82},
//5
                { 0.91, 0.86, 0.72, 0.62, 0.53, 0.41, 0.34, 0.23, 0.165, 0.532},
                { 0.34, 0.82, 0.71, 0.63, 0.58, 0.4, 0.32, 0.21, 0.13, 0.8},
                { 0.561, 0.86, 0.76, 0.62, 0.53, 0.41, 0.34, 0.3, 0.165, 0.532},
                { 0.94, 0.82, 0.71, 0.63, 0.58, 0.41, 0.32, 0.21, 0.13, 0.8},
                { 0.71, 0.806, 0.72, 0.62, 0.53, 0.41, 0.34, 0.23, 0.165, 0.332},
                { 0.81, 0.86, 0.72, 0.62, 0.5, 0.41, 0.34, 0.23, 0.165, 0.632},
                { 0.94, 0.82, 0.76, 0.63, 0.5, 0.4, 0.32, 0.21, 0.13, 0.8},
                { 0.74, 0.82, 0.71, 0.66, 0.58, 0.4, 0.32, 0.21, 0.13, 0.63},
                { 0.91, 0.86, 0.72, 0.62, 0.53, 0.1, 0.34, 0.23, 0.165, 0.3256},
                { 0.94, 0.82, 0.71, 0.63, 0.58, 0.1, 0.23, 0.1, 0.13, 0.82},
        };
        double desiredError = 0.000000001;
        double learnRate = 0.61803398875;

        LOGGER.debug("Desired Error: {}", desiredError);
        LOGGER.debug("Learning Rate: {}", learnRate);
        String inputStr = Arrays.deepToString(input);
        LOGGER.debug("Input Values: {}", inputStr);
        String desiredStr = Arrays.deepToString(desired);
        LOGGER.debug("Desired Values: {}", desiredStr);
        double error = bpn.train(input, desired, learnRate + 1, desiredError);
        LOGGER.debug("Error: {}", error);
        bpn.saveNet(System.getProperty("user.home")+"/Documents/main.net");
    }
}
